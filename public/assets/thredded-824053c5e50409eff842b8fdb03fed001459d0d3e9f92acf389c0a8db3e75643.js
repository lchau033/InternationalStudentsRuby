function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(e,t){"object"==typeof module&&module.exports?(module.exports=t(e),module.exports["default"]=module.exports):e.timeago=t(e)}("undefined"!=typeof window?window:this,function(){function e(e){return e instanceof Date?e:isNaN(e)?/^\d+$/.test(e)?new Date(t(e)):(e=(e||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),new Date(e)):new Date(t(e))}function t(e){return parseInt(e)}function n(e,n,r){n=f[n]?n:f[r]?r:"en";for(var o=0,i=e<0?1:0,a=e=Math.abs(e);e>=h[o]&&o<p;o++)e/=h[o];return e=t(e),o*=2,e>(0===o?9:1)&&(o+=1),f[n](e,o,a)[i].replace("%s",e)}function r(t,n){return((n=n?e(n):new Date)-e(t))/1e3}function o(e){for(var t=1,n=0,r=Math.abs(e);e>=h[n]&&n<p;n++)e/=h[n],t*=h[n];return r%=t,r=r?t-r:t,Math.ceil(r)}function i(e){return a(e,"data-timeago")||a(e,"datetime")}function a(e,t){return e.getAttribute?e.getAttribute(t):e.attr?e.attr(t):void 0}function u(e,t){return e.setAttribute?e.setAttribute(m,t):e.attr?e.attr(m,t):void 0}function s(e,t){this.nowDate=e,this.defaultLocale=t||"en"}function c(e,t){return new s(e,t)}var l="second_minute_hour_day_week_month_year".split("_"),d="\u79d2_\u5206\u949f_\u5c0f\u65f6_\u5929_\u5468_\u6708_\u5e74".split("_"),f={en:function(e,t){if(0===t)return["just now","right now"];var n=l[parseInt(t/2)];return e>1&&(n+="s"),[e+" "+n+" ago","in "+e+" "+n]},zh_CN:function(e,t){if(0===t)return["\u521a\u521a","\u7247\u523b\u540e"];var n=d[parseInt(t/2)];return[e+n+"\u524d",e+n+"\u540e"]}},h=[60,60,24,7,365/7/12,12],p=6,m="data-tid",v={};return s.prototype.doRender=function(e,t,i){var a,s=r(t,this.nowDate),c=this;e.innerHTML=n(s,i,this.defaultLocale),v[a=setTimeout(function(){c.doRender(e,t,i),delete v[a]},Math.min(1e3*o(s),2147483647))]=0,u(e,a)},s.prototype.format=function(e,t){return n(r(e,this.nowDate),t,this.defaultLocale)},s.prototype.render=function(e,t){e.length===undefined&&(e=[e]);for(var n=0,r=e.length;n<r;n++)this.doRender(e[n],i(e[n]),t)},s.prototype.setLocale=function(e){this.defaultLocale=e},c.register=function(e,t){f[e]=t},c.cancel=function(e){var t;if(e)(t=a(e,m))&&(clearTimeout(t),delete v[t]);else{for(t in v)clearTimeout(t);v={}}},c}),function(){(function(){(function(){this.Rails={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote]:not([disabled]), a[data-disable-with], a[data-disable]",buttonClickSelector:{selector:"button[data-remote]:not([form]), button[data-confirm]:not([form])",exclude:"form button"},inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type]), input[type=submit][form], input[type=image][form], button[type=submit][form], button[form]:not([type])",formDisableSelector:"input[data-disable-with]:enabled, button[data-disable-with]:enabled, textarea[data-disable-with]:enabled, input[data-disable]:enabled, button[data-disable]:enabled, textarea[data-disable]:enabled",formEnableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled, input[data-disable]:disabled, button[data-disable]:disabled, textarea[data-disable]:disabled",fileInputSelector:"input[name][type=file]:not([disabled])",linkDisableSelector:"a[data-disable-with], a[data-disable]",buttonDisableSelector:"button[data-remote][data-disable-with], button[data-remote][data-disable]"}}).call(this)}).call(this);var e=this.Rails;(function(){(function(){var t,n;n=Element.prototype.matches||Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector,e.matches=function(e,t){return null!=t.exclude?n.call(e,t.selector)&&!n.call(e,t.exclude):n.call(e,t)},t="_ujsData",e.getData=function(e,n){var r;return null!=(r=e[t])?r[n]:void 0},e.setData=function(e,n,r){return null==e[t]&&(e[t]={}),e[t][n]=r},e.$=function(e){return Array.prototype.slice.call(document.querySelectorAll(e))}}).call(this),function(){var t,n,r;t=e.$,r=e.csrfToken=function(){var e;return(e=document.querySelector("meta[name=csrf-token]"))&&e.content},n=e.csrfParam=function(){var e;return(e=document.querySelector("meta[name=csrf-param]"))&&e.content},e.CSRFProtection=function(e){var t;if(null!=(t=r()))return e.setRequestHeader("X-CSRF-Token",t)},e.refreshCSRFTokens=function(){var e,o;if(o=r(),e=n(),null!=o&&null!=e)return t('form input[name="'+e+'"]').forEach(function(e){return e.value=o})}}.call(this),function(){var t,n,r;r=e.matches,t=window.CustomEvent,"function"!=typeof t&&(t=function(e,t){var n;return n=document.createEvent("CustomEvent"),n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n},t.prototype=window.Event.prototype),n=e.fire=function(e,n,r){var o;return o=new t(n,{bubbles:!0,cancelable:!0,detail:r}),e.dispatchEvent(o),!o.defaultPrevented},e.stopEverything=function(e){return n(e.target,"ujs:everythingStopped"),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()},e.delegate=function(e,t,n,o){return e.addEventListener(n,function(e){var n;for(n=e.target;n instanceof Element&&!r(n,t);)n=n.parentNode;if(n instanceof Element&&!1===o.call(n,e))return e.preventDefault(),e.stopPropagation()})}}.call(this),function(){var t,n,r,o,i,a;n=e.CSRFProtection,o=e.fire,t={"*":"*/*",text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript",script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},e.ajax=function(e){var t;return e=i(e),t=r(e,function(){var n;return n=a(t.response,t.getResponseHeader("Content-Type")),2===Math.floor(t.status/100)?"function"==typeof e.success&&e.success(n,t.statusText,t):"function"==typeof e.error&&e.error(n,t.statusText,t),"function"==typeof e.complete?e.complete(t,t.statusText):void 0}),"function"==typeof e.beforeSend&&e.beforeSend(t,e),t.readyState===XMLHttpRequest.OPENED?t.send(e.data):o(document,"ajaxStop")},i=function(e){return e.type=e.type.toUpperCase(),"GET"===e.type&&e.data&&(e.url.indexOf("?")<0?e.url+="?"+e.data:e.url+="&"+e.data),null==t[e.dataType]&&(e.dataType="*"),e.accept=t[e.dataType],"*"!==e.dataType&&(e.accept+=", */*; q=0.01"),e},r=function(e,t){var r;return r=new XMLHttpRequest,r.open(e.type,e.url,!0),r.setRequestHeader("Accept",e.accept),"string"==typeof e.data&&r.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),e.crossDomain||r.setRequestHeader("X-Requested-With","XMLHttpRequest"),n(r),r.withCredentials=!!e.withCredentials,r.onreadystatechange=function(){if(r.readyState===XMLHttpRequest.DONE)return t(r)},r},a=function(e,t){var n,r;if("string"==typeof e&&"string"==typeof t)if(t.match(/\bjson\b/))try{e=JSON.parse(e)}catch(e){}else if(t.match(/\bjavascript\b/))r=document.createElement("script"),r.innerHTML=e,document.body.appendChild(r);else if(t.match(/\b(xml|html|svg)\b/)){n=new DOMParser,t=t.replace(/;.+/,"");try{e=n.parseFromString(e,t)}catch(e){}}return e},e.href=function(e){return e.href},e.isCrossDomain=function(e){var t,n;t=document.createElement("a"),t.href=location.href,n=document.createElement("a");try{return n.href=e,!((!n.protocol||":"===n.protocol)&&!n.host||t.protocol+"//"+t.host==n.protocol+"//"+n.host)}catch(e){return e,!0}}}.call(this),function(){var t,n;t=e.matches,n=function(e){return Array.prototype.slice.call(e)},e.serializeElement=function(e,r){var o,i;return o=[e],t(e,"form")&&(o=n(e.elements)),i=[],o.forEach(function(e){if(e.name)return t(e,"select")?n(e.options).forEach(function(t){if(t.selected)return i.push({name:e.name,value:t.value})}):e.checked||-1===["radio","checkbox","submit"].indexOf(e.type)?i.push({name:e.name,value:e.value}):void 0}),r&&i.push(r),i.map(function(e){return null!=e.name?encodeURIComponent(e.name)+"="+encodeURIComponent(e.value):e}).join("&")},e.formElements=function(e,r){return t(e,"form")?n(e.elements).filter(function(e){return t(e,r)}):n(e.querySelectorAll(r))}}.call(this),function(){var t,n,r;n=e.fire,r=e.stopEverything,e.handleConfirm=function(e){if(!t(this))return r(e)},t=function(e){var t,r,o;if(!(o=e.getAttribute("data-confirm")))return!0;if(t=!1,n(e,"confirm")){try{t=confirm(o)}catch(e){}r=n(e,"confirm:complete",[t])}return t&&r}}.call(this),function(){var t,n,r,o,i,a,u,s,c,l,d;c=e.matches,s=e.getData,l=e.setData,d=e.stopEverything,u=e.formElements,e.enableElement=function(t){var n;return n=t instanceof Event?t.target:t,c(n,e.linkDisableSelector)?a(n):c(n,e.buttonDisableSelector)||c(n,e.formEnableSelector)?o(n):c(n,e.formSubmitSelector)?i(n):void 0},e.disableElement=function(o){var i;return i=o instanceof Event?o.target:o,c(i,e.linkDisableSelector)?r(i):c(i,e.buttonDisableSelector)||c(i,e.formDisableSelector)?t(i):c(i,e.formSubmitSelector)?n(i):void 0},r=function(e){var t;return t=e.getAttribute("data-disable-with"),null!=t&&(l(e,"ujs:enable-with",e.innerHTML),e.innerHTML=t),e.addEventListener("click",d),l(e,"ujs:disabled",!0)},a=function(e){var t;return t=s(e,"ujs:enable-with"),null!=t&&(e.innerHTML=t,l(e,"ujs:enable-with",null)),e.removeEventListener("click",d),l(e,"ujs:disabled",null)},n=function(n){return u(n,e.formDisableSelector).forEach(t)},t=function(e){var t;return t=e.getAttribute("data-disable-with"),null!=t&&(c(e,"button")?(l(e,"ujs:enable-with",e.innerHTML),e.innerHTML=t):(l(e,"ujs:enable-with",e.value),e.value=t)),e.disabled=!0,l(e,"ujs:disabled",!0)},i=function(t){return u(t,e.formEnableSelector).forEach(o)},o=function(e){var t;return t=s(e,"ujs:enable-with"),null!=t&&(c(e,"button")?e.innerHTML=t:e.value=t,l(e,"ujs:enable-with",null)),e.disabled=!1,l(e,"ujs:disabled",null)}}.call(this),function(){var t;t=e.stopEverything,e.handleMethod=function(n){var r,o,i,a,u,s,c;if(s=this,c=s.getAttribute("data-method"))return u=e.href(s),o=e.csrfToken(),r=e.csrfParam(),i=document.createElement("form"),a="<input name='_method' value='"+c+"' type='hidden' />",null==r||null==o||e.isCrossDomain(u)||(a+="<input name='"+r+"' value='"+o+"' type='hidden' />"),a+='<input type="submit" />',i.method="post",i.action=u,i.target=s.target,i.innerHTML=a,i.style.display="none",document.body.appendChild(i),i.querySelector('[type="submit"]').click(),t(n)}}.call(this),function(){var t,n,r,o,i,a,u,s,c,l=[].slice;a=e.matches,r=e.getData,s=e.setData,n=e.fire,c=e.stopEverything,t=e.ajax,o=e.isCrossDomain,u=e.serializeElement,i=function(e){var t;return null!=(t=e.getAttribute("data-remote"))&&"false"!==t},e.handleRemote=function(d){var f,h,p,m,v,y,b;return m=this,!i(m)||(n(m,"ajax:before")?(b=m.getAttribute("data-with-credentials"),p=m.getAttribute("data-type")||"script",a(m,e.formSubmitSelector)?(f=r(m,"ujs:submit-button"),v=r(m,"ujs:submit-button-formmethod")||m.method,y=r(m,"ujs:submit-button-formaction")||m.getAttribute("action")||location.href,"GET"===v.toUpperCase()&&(y=y.replace(/\?.*$/,"")),"multipart/form-data"===m.enctype?(h=new FormData(m),null!=f&&h.append(f.name,f.value)):h=u(m,f),s(m,"ujs:submit-button",null),s(m,"ujs:submit-button-formmethod",null),s(m,"ujs:submit-button-formaction",null)):a(m,e.buttonClickSelector)||a(m,e.inputChangeSelector)?(v=m.getAttribute("data-method"),y=m.getAttribute("data-url"),h=u(m,m.getAttribute("data-params"))):(v=m.getAttribute("data-method"),y=e.href(m),h=m.getAttribute("data-params")),t({type:v||"GET",url:y,data:h,dataType:p,beforeSend:function(e,t){return n(m,"ajax:beforeSend",[e,t])?n(m,"ajax:send",[e]):(n(m,"ajax:stopped"),e.abort())},success:function(){var e;return e=1<=arguments.length?l.call(arguments,0):[],n(m,"ajax:success",e)},error:function(){var e;return e=1<=arguments.length?l.call(arguments,0):[],n(m,"ajax:error",e)},complete:function(){var e;return e=1<=arguments.length?l.call(arguments,0):[],n(m,"ajax:complete",e)},crossDomain:o(y),withCredentials:null!=b&&"false"!==b}),c(d)):(n(m,"ajax:stopped"),!1))},e.formSubmitButtonClick=function(){var e,t;if(e=this,t=e.form)return e.name&&s(t,"ujs:submit-button",{name:e.name,value:e.value}),s(t,"ujs:formnovalidate-button",e.formNoValidate),s(t,"ujs:submit-button-formaction",e.getAttribute("formaction")),s(t,"ujs:submit-button-formmethod",e.getAttribute("formmethod"))},e.handleMetaClick=function(e){var t,n,r;if(n=this,r=(n.getAttribute("data-method")||"GET").toUpperCase(),t=n.getAttribute("data-params"),(e.metaKey||e.ctrlKey)&&"GET"===r&&!t)return e.stopImmediatePropagation()}}.call(this),function(){var t,n,r,o,i,a,u,s,c,l,d,f,h;a=e.fire,r=e.delegate,s=e.getData,t=e.$,h=e.refreshCSRFTokens,n=e.CSRFProtection,i=e.enableElement,o=e.disableElement,c=e.handleConfirm,f=e.handleRemote,u=e.formSubmitButtonClick,l=e.handleMetaClick,d=e.handleMethod,"undefined"==typeof jQuery||null===jQuery||jQuery.rails||(jQuery.rails=e,jQuery.ajaxPrefilter(function(e,t,r){if(!e.crossDomain)return n(r)})),e.start=function(){if(window._rails_loaded)throw new Error("rails-ujs has already been loaded!");return window.addEventListener("pageshow",function(){return t(e.formEnableSelector).forEach(function(e){if(s(e,"ujs:disabled"))return i(e)}),t(e.linkDisableSelector).forEach(function(e){if(s(e,"ujs:disabled"))return i(e)})}),r(document,e.linkDisableSelector,"ajax:complete",i),r(document,e.linkDisableSelector,"ajax:stopped",i),r(document,e.buttonDisableSelector,"ajax:complete",i),r(document,e.buttonDisableSelector,"ajax:stopped",i),r(document,e.linkClickSelector,"click",c),r(document,e.linkClickSelector,"click",l),r(document,e.linkClickSelector,"click",o),r(document,e.linkClickSelector,"click",f),r(document,e.linkClickSelector,"click",d),r(document,e.buttonClickSelector,"click",c),r(document,e.buttonClickSelector,"click",o),r(document,e.buttonClickSelector,"click",f),r(document,e.inputChangeSelector,"change",c),r(document,e.inputChangeSelector,"change",f),r(document,e.formSubmitSelector,"submit",c),r(document,e.formSubmitSelector,"submit",f),r(document,e.formSubmitSelector,"submit",function(e){return setTimeout(function(){return o(e)},13)}),r(document,e.formSubmitSelector,"ajax:send",o),r(document,e.formSubmitSelector,"ajax:complete",i),r(document,e.formInputClickSelector,"click",c),r(document,e.formInputClickSelector,"click",u),document.addEventListener("DOMContentLoaded",h),window._rails_loaded=!0},window.Rails===e&&a(document,"rails:attachBindings")&&e.start()}.call(this)}).call(this),"object"==typeof module&&module.exports?module.exports=e:"function"==typeof define&&define.amd&&define(e)}.call(this),function(e,t){if("function"==typeof define&&define.amd)define(["exports","module"],t);else if("undefined"!=typeof exports&&"undefined"!=typeof module)t(exports,module);else{var n={exports:{}};t(n.exports,n),e.autosize=n.exports}}(this,function(e,t){"use strict";function n(e){function t(){var t=window.getComputedStyle(e,null);"vertical"===t.resize?e.style.resize="none":"both"===t.resize&&(e.style.resize="horizontal"),s="content-box"===t.boxSizing?-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)):parseFloat(t.borderTopWidth)+parseFloat(t.borderBottomWidth),isNaN(s)&&(s=0),u()}function n(t){var n=e.style.width;e.style.width="0px",e.offsetWidth,e.style.width=n,e.style.overflowY=t}function r(e){for(var t=[];e&&e.parentNode&&e.parentNode instanceof Element;)e.parentNode.scrollTop&&t.push({node:e.parentNode,scrollTop:e.parentNode.scrollTop}),e=e.parentNode;return t}function o(){var t=e.style.height,n=r(e),o=document.documentElement&&document.documentElement.scrollTop;e.style.height="";var i=e.scrollHeight+s;return 0===e.scrollHeight?void(e.style.height=t):(e.style.height=i+"px",c=e.clientWidth,n.forEach(function(e){e.node.scrollTop=e.scrollTop}),void(o&&(document.documentElement.scrollTop=o)))}function u(){o();var t=Math.round(parseFloat(e.style.height)),r=window.getComputedStyle(e,null),i="content-box"===r.boxSizing?Math.round(parseFloat(r.height)):e.offsetHeight;if(i!==t?"hidden"===r.overflowY&&(n("scroll"),o(),i="content-box"===r.boxSizing?Math.round(parseFloat(window.getComputedStyle(e,null).height)):e.offsetHeight):"hidden"!==r.overflowY&&(n("hidden"),o(),i="content-box"===r.boxSizing?Math.round(parseFloat(window.getComputedStyle(e,null).height)):e.offsetHeight),l!==i){l=i;var u=a("autosize:resized");try{e.dispatchEvent(u)}catch(e){}}}if(e&&e.nodeName&&"TEXTAREA"===e.nodeName&&!i.has(e)){var s=null,c=e.clientWidth,l=null,d=function(){e.clientWidth!==c&&u()},f=function(t){window.removeEventListener("resize",d,!1),e.removeEventListener("input",u,!1),e.removeEventListener("keyup",u,!1),e.removeEventListener("autosize:destroy",f,!1),e.removeEventListener("autosize:update",u,!1),Object.keys(t).forEach(function(n){e.style[n]=t[n]}),i["delete"](e)}.bind(e,{height:e.style.height,resize:e.style.resize,overflowY:e.style.overflowY,overflowX:e.style.overflowX,wordWrap:e.style.wordWrap});e.addEventListener("autosize:destroy",f,!1),"onpropertychange"in e&&"oninput"in e&&e.addEventListener("keyup",u,!1),window.addEventListener("resize",d,!1),e.addEventListener("input",u,!1),e.addEventListener("autosize:update",u,!1),e.style.overflowX="hidden",e.style.wordWrap="break-word",i.set(e,{destroy:f,update:u}),t()}}function r(e){var t=i.get(e);t&&t.destroy()}function o(e){var t=i.get(e);t&&t.update()}var i="function"==typeof Map?new Map:function(){var e=[],t=[];return{has:function(t){return e.indexOf(t)>-1},get:function(n){return t[e.indexOf(n)]},set:function(n,r){-1===e.indexOf(n)&&(e.push(n),t.push(r))},"delete":function(n){var r=e.indexOf(n);r>-1&&(e.splice(r,1),t.splice(r,1))}}}(),a=function(e){return new Event(e,{bubbles:!0})};try{new Event("test")}catch(e){a=function(e){var t=document.createEvent("Event");return t.initEvent(e,!0,!1),t}}var u=null;"undefined"==typeof window||"function"!=typeof window.getComputedStyle?(u=function(e){return e},u.destroy=function(e){return e},u.update=function(e){return e}):(u=function(e,t){return e&&Array.prototype.forEach.call(e.length?e:[e],function(e){return n(e,t)}),e},u.destroy=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],r),e},u.update=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],o),e}),t.exports=u}),function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=11)}([function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),a=(function(e){e&&e.__esModule}(i),function(){function e(t,n,o){r(this,e),this.data=t,this.term=n,this.strategy=o}return o(e,[{key:"replace",value:function(e,t){var n=this.strategy.replace(this.data);if(null!==n){Array.isArray(n)&&(t=n[1]+t,n=n[0]);var r=this.strategy.matchText(e);if(r)return n=n.replace(/\$&/g,r[0]).replace(/\$(\d+)/g,function(e,t){return r[parseInt(t,10)]}),[[e.slice(0,r.index),n,e.slice(r.index+r[0].length)].join(""),t]}}},{key:"render",value:function(){return this.strategy.template(this.data,this.term)}}]),e}());t["default"]=a},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){return e}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(12),u=function(e){return e&&e.__esModule?e:{"default":e}}(a),s=function(){function e(t){r(this,e),this.props=t,this.cache=t.cache?{}:null}return i(e,[{key:"destroy",value:function(){return this.cache=null,this}},{key:"buildQuery",value:function(e){if("function"==typeof this.props.context){var t=this.props.context(e);if("string"==typeof t)e=t;else if(!t)return null}var n=this.matchText(e);return n?new u["default"](this,n[this.index],n):null}},{key:"search",value:function(e,t,n){this.cache?this.searchWithCache(e,t,n):this.props.search(e,t,n)}},{key:"replace",value:function(e){return this.props.replace(e)}},{key:"searchWithCache",value:function(e,t,n){var r=this;this.cache&&this.cache[e]?t(this.cache[e]):this.props.search(e,function(n){r.cache&&(r.cache[e]=n),t(n)},n)}},{key:"matchText",value:function(e){return"function"==typeof this.match?this.match(e):e.match(this.match)}},{key:"match",get:function(){return this.props.match}},{key:"index",get:function(){return"number"==typeof this.props.index?this.props.index:2}},{key:"template",get:function(){return this.props.template||o}}]),e}();t["default"]=s},function(e){"use strict";function t(){}function n(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function r(){this._events=new t,this._eventsCount=0}var o=Object.prototype.hasOwnProperty,i="~";Object.create&&(t.prototype=Object.create(null),(new t).__proto__||(i=!1)),r.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)o.call(e,t)&&n.push(i?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},r.prototype.listeners=function(e,t){var n=i?i+e:e,r=this._events[n];if(t)return!!r;if(!r)return[];if(r.fn)return[r.fn];for(var o=0,a=r.length,u=new Array(a);o<a;o++)u[o]=r[o].fn;return u},r.prototype.emit=function(e,t,n,r,o,a){var u=i?i+e:e;if(!this._events[u])return!1;var s,c,l=this._events[u],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,r),!0;case 5:return l.fn.call(l.context,t,n,r,o),!0;case 6:return l.fn.call(l.context,t,n,r,o,a),!0}for(c=1,s=new Array(d-1);c<d;c++)s[c-1]=arguments[c];l.fn.apply(l.context,s)}else{var f,h=l.length;for(c=0;c<h;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),d){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,n);break;case 4:l[c].fn.call(l[c].context,t,n,r);break;default:if(!s)for(f=1,s=new Array(d-1);f<d;f++)s[f-1]=arguments[f];l[c].fn.apply(l[c].context,s)}}return!0},r.prototype.on=function(e,t,r){var o=new n(t,r||this),a=i?i+e:e;return this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],o]:this._events[a].push(o):(this._events[a]=o,this._eventsCount++),this},r.prototype.once=function(e,t,r){var o=new n(t,r||this,!0),a=i?i+e:e;return this._events[a]?this._events[a].fn?this._events[a]=[this._events[a],o]:this._events[a].push(o):(this._events[a]=o,this._eventsCount++),this},r.prototype.removeListener=function(e,n,r,o){var a=i?i+e:e;if(!this._events[a])return this;if(!n)return 0==--this._eventsCount?this._events=new t:delete this._events[a],this;var u=this._events[a];if(u.fn)u.fn!==n||o&&!u.once||r&&u.context!==r||(0==--this._eventsCount?this._events=new t:delete this._events[a]);else{for(var s=0,c=[],l=u.length;s<l;s++)(u[s].fn!==n||o&&!u[s].once||r&&u[s].context!==r)&&c.push(u[s]);c.length?this._events[a]=1===c.length?c[0]:c:0==--this._eventsCount?this._events=new t:delete this._events[a]}return this},r.prototype.removeAllListeners=function(e){var n;return e?(n=i?i+e:e,this._events[n]&&(0==--this._eventsCount?this._events=new t:delete this._events[n])):(this._events=new t,this._eventsCount=0),this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prototype.setMaxListeners=function(){return this},r.prefixed=i,r.EventEmitter=r,e.exports=r},function(e,t){"use strict";function n(e){var t=e.getBoundingClientRect(),n=e.ownerDocument,r=n.defaultView,o=n.documentElement,i={top:t.top+r.pageYOffset,left:t.left+r.pageXOffset};return o&&(i.top-=o.clientTop,i.left-=o.clientLeft),i}function r(e){return e>=i&&e<=a}function o(e){var t=window.getComputedStyle(e);if(r(t.lineHeight.charCodeAt(0)))return r(t.lineHeight.charCodeAt(t.lineHeight.length-1))?parseFloat(t.lineHeight)*parseFloat(t.fontSize):parseFloat(t.lineHeight);var n=document.body;if(!n)return 0;var o=document.createElement(e.nodeName);o.innerHTML="&nbsp;",o.style.fontSize=t.fontSize,o.style.fontFamily=t.fontFamily,n.appendChild(o);var i=o.offsetHeight;return n.removeChild(o),i}Object.defineProperty(t,"__esModule",{value:!0}),t.calculateElementOffset=n,t.getLineHeightPx=o;var i=(t.createCustomEvent=function(){return"function"==typeof window.CustomEvent?function(e,t){return new document.defaultView.CustomEvent(e,{cancelable:t&&t.cancelable||!1,detail:t&&t.detail||void 0})}:function(e,t){var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,t&&t.cancelable||!1,t&&t.detail||void 0),n}}(),"0".charCodeAt(0)),a="9".charCodeAt(0)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(2),c=r(s),l=n(10),d=r(l),f=n(0),h=(r(f),n(3)),p="dropdown-menu textcomplete-dropdown",m=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));n.shown=!1,n.items=[],n.footer=e.footer,n.header=e.header,n.maxCount=e.maxCount||10,n.el.className=e.className||p,n.rotate=!e.hasOwnProperty("rotate")||e.rotate,n.placement=e.placement;var r=e.style;return r&&Object.keys(r).forEach(function(e){n.el.style[e]=r[e]}),n}return a(t,e),u(t,null,[{key:"createElement",value:function(){var e=document.createElement("ul"),t=e.style;t.display="none",t.position="absolute",t.zIndex="10000";var n=document.body;return n&&n.appendChild(e),e}}]),u(t,[{key:"destroy",value:function(){var e=this.el.parentNode;return e&&e.removeChild(this.el),this.clear()._el=null,this}},{key:"render",value:function(e,t){var n=(0,h.createCustomEvent)("render",{cancelable:!0});if(this.emit("render",n),n.defaultPrevented)return this;var r=e.map(function(e){return e.data}),o=e.slice(0,this.maxCount||e.length).map(function(e){return new d["default"](e)});return this.clear().setStrategyId(e[0]).renderEdge(r,"header").append(o).renderEdge(r,"footer").setOffset(t).show(),this.emit("rendered",(0,h.createCustomEvent)("rendered")),this}},{key:"deactivate",value:function(){return this.hide().clear()}},{key:"select",value:function(e){var t={searchResult:e.searchResult},n=(0,h.createCustomEvent)("select",{cancelable:!0,detail:t});return this.emit("select",n),n.defaultPrevented?this:(this.deactivate(),this.emit("selected",(0,h.createCustomEvent)("selected",{detail:t})),this)}},{key:"up",value:function(e){return this.shown?this.moveActiveItem("prev",e):this}},{key:"down",value:function(e){return this.shown?this.moveActiveItem("next",e):this}},{key:"getActiveItem",value:function(){return this.items.find(function(e){return e.active})}},{key:"append",value:function(e){var t=this,n=document.createDocumentFragment();return e.forEach(function(e){t.items.push(e),e.appended(t),n.appendChild(e.el)}),this.el.appendChild(n),this}},{key:"setOffset",value:function(e){if(e.left?this.el.style.left=e.left+"px":e.right&&(this.el.style.right=e.right+"px"),this.isPlacementTop()){var t=document.documentElement;t&&(this.el.style.bottom=t.clientHeight-e.top+e.lineHeight+"px")}else this.el.style.top=e.top+"px";return this}},{key:"show",value:function(){if(!this.shown){var e=(0,h.createCustomEvent)("show",{cancelable:!0});if(this.emit("show",e),e.defaultPrevented)return this;this.el.style.display="block",this.shown=!0,this.emit("shown",(0,h.createCustomEvent)("shown"))}return this}},{key:"hide",value:function(){if(this.shown){var e=(0,h.createCustomEvent)("hide",{cancelable:!0});if(this.emit("hide",e),e.defaultPrevented)return this;this.el.style.display="none",this.shown=!1,this.emit("hidden",(0,h.createCustomEvent)("hidden"))}return this}},{key:"clear",value:function(){return this.el.innerHTML="",this.items.forEach(function(e){return e.destroy()}),this.items=[],this}},{key:"moveActiveItem",value:function(e,t){var n=this.getActiveItem(),r=void 0;return r=n?n[e]:"next"===e?this.items[0]:this.items[this.items.length-1],r&&(r.activate(),t.preventDefault()),this}},{key:"setStrategyId",value:function(e){var t=e&&e.strategy.props.id;return t?this.el.setAttribute("data-strategy",t):this.el.removeAttribute("data-strategy"),this}},{key:"renderEdge",value:function(e,t){var n=("header"===t?this.header:this.footer)||"",r="function"==typeof n?n(e):n,o=document.createElement("li");return o.classList.add("textcomplete-"+t),o.innerHTML=r,this.el.appendChild(o),this}},{key:"isPlacementTop",value:function(){return"top"===this.placement}},{key:"el",get:function(){return this._el||(this._el=t.createElement()),this._el}}]),t}(c["default"]);t["default"]=m},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(2),c=r(s),l=n(3),d=n(0),f=(r(d),function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),u(t,[{key:"destroy",value:function(){return this}},{key:"applySearchResult",value:function(){throw new Error("Not implemented.")}},{key:"getCursorOffset",value:function(){throw new Error("Not implemented.")}},{key:"getBeforeCursor",value:function(){throw new Error("Not implemented.")}},{key:"getAfterCursor",value:function(){throw new Error("Not implemented.")}},{key:"emitMoveEvent",value:function(e){var t=(0,l.createCustomEvent)("move",{cancelable:!0,detail:{code:e}});return this.emit("move",t),t}},{key:"emitEnterEvent",value:function(){var e=(0,l.createCustomEvent)("enter",{cancelable:!0});return this.emit("enter",e),e}},{key:"emitChangeEvent",value:function(){var e=(0,l.createCustomEvent)("change",{detail:{beforeCursor:this.getBeforeCursor()}});return this.emit("change",e),e}},{key:"emitEscEvent",value:function(){var e=(0,l.createCustomEvent)("esc",{cancelable:!0});return this.emit("esc",e),e}},{key:"getCode",value:function(e){return 8===e.keyCode?"BS":9===e.keyCode?"ENTER":13===e.keyCode?"ENTER":16===e.keyCode?"META":17===e.keyCode?"META":18===e.keyCode?"META":27===e.keyCode?"ESC":38===e.keyCode?"UP":40===e.keyCode?"DOWN":78===e.keyCode&&e.ctrlKey?"DOWN":80===e.keyCode&&e.ctrlKey?"UP":91===e.keyCode?"META":93===e.keyCode?"META":"OTHER"}}]),t}(c["default"]));t["default"]=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){
if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},c=n(14),l=r(c),d=n(5),f=r(d),h=n(3),p=n(0),m=(r(p),n(13)),v=["onInput","onKeydown"],y=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.el=e,v.forEach(function(e){n[e]=n[e].bind(n)}),n.startListening(),n}return a(t,e),u(t,[{key:"destroy",value:function(){return s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this),this.stopListening(),this.el=null,this}},{key:"applySearchResult",value:function(e){var t=e.replace(this.getBeforeCursor(),this.getAfterCursor());this.el.focus(),Array.isArray(t)&&((0,l["default"])(this.el,t[0],t[1]),this.el.dispatchEvent(new Event("input")))}},{key:"getCursorOffset",value:function(){var e=(0,h.calculateElementOffset)(this.el),t=this.getElScroll(),n=this.getCursorPosition(),r=(0,h.getLineHeightPx)(this.el),o=e.top-t.top+n.top+r,i=e.left-t.left+n.left;return"rtl"!==this.el.dir?{top:o,left:i,lineHeight:r}:{top:o,right:document.documentElement?document.documentElement.clientWidth-i:0,lineHeight:r}}},{key:"getBeforeCursor",value:function(){return this.el.value.substring(0,this.el.selectionEnd)}},{key:"getAfterCursor",value:function(){return this.el.value.substring(this.el.selectionEnd)}},{key:"getElScroll",value:function(){return{top:this.el.scrollTop,left:this.el.scrollLeft}}},{key:"getCursorPosition",value:function(){return m(this.el,this.el.selectionEnd)}},{key:"onInput",value:function(){this.emitChangeEvent()}},{key:"onKeydown",value:function(e){var t=this.getCode(e),n=void 0;"UP"===t||"DOWN"===t?n=this.emitMoveEvent(t):"ENTER"===t?n=this.emitEnterEvent():"ESC"===t&&(n=this.emitEscEvent()),n&&n.defaultPrevented&&e.preventDefault()}},{key:"startListening",value:function(){this.el.addEventListener("input",this.onInput),this.el.addEventListener("keydown",this.onKeydown)}},{key:"stopListening",value:function(){this.el.removeEventListener("input",this.onInput),this.el.removeEventListener("keydown",this.onKeydown)}}]),t}(f["default"]);t["default"]=y},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(9),c=r(s),l=n(5),d=(r(l),n(4)),f=r(d),h=n(1),p=r(h),m=n(0),v=(r(m),n(2)),y=r(v),b=["handleChange","handleEnter","handleEsc","handleHit","handleMove","handleSelect"],w=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.completer=new c["default"],r.isQueryInFlight=!1,r.nextPendingQuery=null,r.dropdown=new f["default"](n.dropdown||{}),r.editor=e,r.options=n,b.forEach(function(e){r[e]=r[e].bind(r)}),r.startListening(),r}return a(t,e),u(t,[{key:"destroy",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.completer.destroy(),this.dropdown.destroy(),e&&this.editor.destroy(),this.stopListening(),this}},{key:"register",value:function(e){var t=this;return e.forEach(function(e){t.completer.registerStrategy(new p["default"](e))}),this}},{key:"trigger",value:function(e){return this.isQueryInFlight?this.nextPendingQuery=e:(this.isQueryInFlight=!0,this.nextPendingQuery=null,this.completer.run(e)),this}},{key:"handleHit",value:function(e){var t=e.searchResults;t.length?this.dropdown.render(t,this.editor.getCursorOffset()):this.dropdown.deactivate(),this.isQueryInFlight=!1,null!==this.nextPendingQuery&&this.trigger(this.nextPendingQuery)}},{key:"handleMove",value:function(e){"UP"===e.detail.code?this.dropdown.up(e):this.dropdown.down(e)}},{key:"handleEnter",value:function(e){var t=this.dropdown.getActiveItem();t&&(this.dropdown.select(t),e.preventDefault())}},{key:"handleEsc",value:function(e){this.dropdown.shown&&(this.dropdown.deactivate(),e.preventDefault())}},{key:"handleChange",value:function(e){this.trigger(e.detail.beforeCursor)}},{key:"handleSelect",value:function(e){this.emit("select",e),e.defaultPrevented||this.editor.applySearchResult(e.detail.searchResult)}},{key:"startListening",value:function(){var e=this;this.editor.on("move",this.handleMove).on("enter",this.handleEnter).on("esc",this.handleEsc).on("change",this.handleChange),this.dropdown.on("select",this.handleSelect),["show","shown","render","rendered","selected","hidden","hide"].forEach(function(t){e.dropdown.on(t,function(){return e.emit(t)})}),this.completer.on("hit",this.handleHit)}},{key:"stopListening",value:function(){this.completer.removeAllListeners(),this.dropdown.removeAllListeners(),this.editor.removeListener("move",this.handleMove).removeListener("enter",this.handleEnter).removeListener("esc",this.handleEsc).removeListener("change",this.handleChange)}}]),t}(y["default"]);t["default"]=w},function(e){var t;t=function(){return this}();try{t=t||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(t=window)}e.exports=t},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=n(2),c=r(s),l=n(1),d=(r(l),n(0)),f=(r(d),["handleQueryResult"]),h=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.strategies=[],f.forEach(function(t){e[t]=e[t].bind(e)}),e}return a(t,e),u(t,[{key:"destroy",value:function(){return this.strategies.forEach(function(e){return e.destroy()}),this}},{key:"registerStrategy",value:function(e){return this.strategies.push(e),this}},{key:"run",value:function(e){var t=this.extractQuery(e);t?t.execute(this.handleQueryResult):this.handleQueryResult([])}},{key:"extractQuery",value:function(e){for(var t=0;t<this.strategies.length;t++){var n=this.strategies[t].buildQuery(e);if(n)return n}return null}},{key:"handleQueryResult",value:function(e){this.emit("hit",{searchResults:e})}}]),t}(c["default"]);t["default"]=h},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.CLASS_NAME=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(4),u=(r(a),n(0)),s=(r(u),t.CLASS_NAME="textcomplete-item"),c=s+" active",l=["onClick","onMouseover"],d=function(){function e(t){var n=this;o(this,e),this.searchResult=t,this.active=!1,l.forEach(function(e){n[e]=n[e].bind(n)})}return i(e,[{key:"destroy",value:function(){this.el.removeEventListener("mousedown",this.onClick,!1),this.el.removeEventListener("mouseover",this.onMouseover,!1),this.el.removeEventListener("touchstart",this.onClick,!1),this._el=null}},{key:"appended",value:function(e){this.dropdown=e,this.siblings=e.items,this.index=this.siblings.length-1}},{key:"activate",value:function(){if(!this.active){var e=this.dropdown.getActiveItem();e&&e.deactivate(),this.active=!0,this.el.className=c}return this}},{key:"deactivate",value:function(){return this.active&&(this.active=!1,this.el.className=s),this}},{key:"onClick",value:function(e){e.preventDefault(),this.dropdown.select(this)}},{key:"onMouseover",value:function(){this.activate()}},{key:"el",get:function(){if(this._el)return this._el;var e=document.createElement("li");e.className=this.active?c:s;var t=document.createElement("a");return t.innerHTML=this.searchResult.render(),e.appendChild(t),this._el=e,e.addEventListener("mousedown",this.onClick),e.addEventListener("mouseover",this.onMouseover),e.addEventListener("touchstart",this.onClick),e}},{key:"next",get:function(){var e=void 0;if(this.index===this.siblings.length-1){if(!this.dropdown.rotate)return null;e=0}else e=this.index+1;return this.siblings[e]}},{key:"prev",get:function(){var e=void 0;if(0===this.index){if(!this.dropdown.rotate)return null;e=this.siblings.length-1}else e=this.index-1;return this.siblings[e]}}]),e}();t["default"]=d},function(e,t,n){"use strict";(function(e){function t(e){return e&&e.__esModule?e:{"default":e}}var r=n(7),o=t(r),i=n(6),a=t(i),u=void 0;u=e.Textcomplete&&e.Textcomplete.editors?e.Textcomplete.editors:{},u.Textarea=a["default"],e.Textcomplete=o["default"],e.Textcomplete.editors=u}).call(t,n(8))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(0),u=r(a),s=n(1),c=(r(s),function(){function e(t,n,r){o(this,e),this.strategy=t,this.term=n,this.match=r}return i(e,[{key:"execute",value:function(e){var t=this;this.strategy.search(this.term,function(n){e(n.map(function(e){return new u["default"](e,t.term,t.strategy)}))},this.match)}}]),e}());t["default"]=c},function(e){!function(){function t(e,t,i){if(!r)throw new Error("textarea-caret-position#getCaretCoordinates should only be called in a browser");var a=i&&i.debug||!1;if(a){var u=document.querySelector("#input-textarea-caret-position-mirror-div");u&&u.parentNode.removeChild(u)}var s=document.createElement("div");s.id="input-textarea-caret-position-mirror-div",document.body.appendChild(s);var c=s.style,l=window.getComputedStyle?getComputedStyle(e):e.currentStyle;c.whiteSpace="pre-wrap","INPUT"!==e.nodeName&&(c.wordWrap="break-word"),c.position="absolute",a||(c.visibility="hidden"),n.forEach(function(e){c[e]=l[e]}),o?e.scrollHeight>parseInt(l.height)&&(c.overflowY="scroll"):c.overflow="hidden",s.textContent=e.value.substring(0,t),"INPUT"===e.nodeName&&(s.textContent=s.textContent.replace(/\s/g,"\xc2 "));var d=document.createElement("span");d.textContent=e.value.substring(t)||".",s.appendChild(d);var f={top:d.offsetTop+parseInt(l.borderTopWidth),left:d.offsetLeft+parseInt(l.borderLeftWidth)};return a?d.style.backgroundColor="#aaa":document.body.removeChild(s),f}var n=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],r="undefined"!=typeof window,o=r&&null!=window.mozInnerScreenX;void 0!==e&&void 0!==e.exports?e.exports=t:r&&(window.getCaretCoordinates=t)}()},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e,t,n){for(var r=e.value,o=t+(n||""),i=document.activeElement,a=0,u=0;r[a]===o[a];)a++;for(;r[r.length-u-1]===o[o.length-u-1];)u++;a=Math.min(a,r.length-u),e.setSelectionRange(a,r.length-u);var s=o.substring(a,o.length-u);return e.focus(),document.execCommand("insertText",!1,s)||(e.value=o),i&&i.focus(),e.setSelectionRange(t.length,t.length),e}}]),window.Thredded=window.Thredded||{},function(){var e="Turbolinks"in window&&window.Turbolinks.supported,t=e&&"clearCache"in window.Turbolinks,n=!1,r=[],o=function(){r.forEach(function(e){e()}),n=!0};window.Thredded.onPageLoad=function(e){r.push(e),!n&&window.Thredded.DOMContentLoadedFired&&e()},t?(window.Turbolinks.controller.lastRenderedLocation&&document.addEventListener("DOMContentLoaded",function(){o()}),document.addEventListener("turbolinks:load",function(){o()})):(window.Thredded.DOMContentLoadedFired||document.addEventListener("DOMContentLoaded",function(){o()}),e&&document.addEventListener("page:load",function(){o()}))}(),window.Thredded.onPageLoad(function(){"Rails"in window?window.Rails.refreshCSRFTokens():"jQuery"in window&&"rails"in window.jQuery&&window.jQuery.rails.refreshCSRFTokens()}),window.Thredded.debounce=function(e,t,n){var r=null;return function(){var o=this,i=arguments,a=function(){r=null,n||e.apply(o,i)},u=n&&!r;clearTimeout(r),r=setTimeout(a,t||200),u&&e.apply(o,i)}},window.Thredded.escapeHtml=function(e){var t=document.createElement("div");return t.textContent=e,t.innerHTML},window.Thredded.hideSoftKeyboard=function(){var e=document.activeElement;e&&e.blur&&e.blur()},window.Thredded.serializeForm=function(e){return Array.prototype.map.call(e.querySelectorAll("[name]"),function(e){return encodeURIComponent(e.name)+"="+encodeURIComponent(e.value)}).join("&")},function(){var e=window.Thredded,t="thredded--is-expanded",n=function(e){e.target.classList.add(t)},r=function(e){e.target.classList.remove(t)},o=function(e){e.target.classList.toggle(t)},i=function(e){e.addEventListener("mouseenter",n),e.addEventListener("mouseleave",r),e.addEventListener("touchstart",o)};e.onPageLoad(function(){Array.prototype.forEach.call(document.querySelectorAll("[data-thredded-currently-online]"),function(e){i(e)})})}(),function(){document.addEventListener("turbolinks:before-cache",function(){Array.prototype.forEach.call(document.querySelectorAll("[data-thredded-flash-message]"),function(e){e.parentNode.removeChild(e)})})}(),function(){var e=window.Thredded;e.UserTextcomplete={DROPDOWN_CLASS_NAME:"thredded--textcomplete-dropdown",formatUser:function(t){var n=t.avatar_url,r=t.name;return"<div class='thredded--textcomplete-user-result'><img class='thredded--textcomplete-user-result__avatar' src='"+e.escapeHtml(n)+"' ><span class='thredded--textcomplete-user-result__name'>"+e.escapeHtml(r)+"</span></div>"},searchFn:function(e){var t=e.url,n=e.autocompleteMinLength;return function(e,r,o){if(e.length<n)return void r([]);var i=new XMLHttpRequest;i.open("GET",t+"?q="+e,!0),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.onload=function(){if(i.status<200||i.status>=400)return void r([]);r(JSON.parse(i.responseText).results.map(function(e){return{avatar_url:e.avatar_url,id:e.id,name:e.name,match:o}}))},i.send()}}},document.addEventListener("turbolinks:before-cache",function(){Array.prototype.forEach.call(document.getElementsByClassName(e.UserTextcomplete.DROPDOWN_CLASS_NAME),function(e){e.parentNode.removeChild(e)})})}();var ThreddedMentionAutocompletion={MATCH_RE:/(^@|\s@)"?([\w.,\- ()]+)$/,DROPDOWN_MAX_COUNT:6,init:function(e,t){var n=new Textcomplete.editors.Textarea(t),r=new Textcomplete(n,{dropdown:{className:Thredded.UserTextcomplete.DROPDOWN_CLASS_NAME,maxCount:ThreddedMentionAutocompletion.DROPDOWN_MAX_COUNT}});r.on("rendered",function(){r.dropdown.items.length&&r.dropdown.items[0].activate()}),r.register([{match:ThreddedMentionAutocompletion.MATCH_RE,search:Thredded.UserTextcomplete.searchFn({url:e.getAttribute("data-autocomplete-url"),autocompleteMinLength:parseInt(e.getAttribute("data-autocomplete-min-length"),10)}),template:Thredded.UserTextcomplete.formatUser,replace:function(e){var t=e.name,n=e.match,r=n[1];return/[., ()]/.test(t)?r+'"'+t+'" ':""+r+t+" "}}])}};window.ThreddedMentionAutocompletion=ThreddedMentionAutocompletion;var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();!function(){var e="[data-thredded-preview-area]",t="[data-thredded-preview-area-post]",n=function(){function n(r,o){var i=this;_classCallCheck(this,n);var a=r.querySelector(e);if(a&&o){this.form=r,this.preview=a,this.previewPost=r.querySelector(t),this.previewUrl=this.preview.getAttribute("data-thredded-preview-url");var u=null,s=Thredded.debounce(function(){u!==o.value&&(i.updatePreview(),u=o.value)},200,!1);o.addEventListener("input",s,!1),this.requestId=0}}return _createClass(n,[{key:"updatePreview",value:function(){var e=this;this.requestId++;var t=this.requestId,n=new XMLHttpRequest;n.open(this.form.method,this.previewUrl,!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.onload=function(){n.status>=200&&n.status<400&&t===e.requestId&&e.onPreviewResponse(n.responseText)},n.send(Thredded.serializeForm(this.form))}},{key:"onPreviewResponse",value:function(e){this.preview.style.display="block",this.previewPost.innerHTML=e}}]),n}();window.ThreddedPreviewArea=n}(),function(){var e=window.Thredded,t=window.ThreddedMentionAutocompletion,n=window.ThreddedPreviewArea,r=window.autosize,o="[data-thredded-post-form]",i='textarea[name$="[content]"]',a=function(e){var o=e.querySelector(i);r(o),new n(e,o),t.init(e,o)},u=function(e){r.destroy(e.querySelector(i))};e.onPageLoad(function(){Array.prototype.forEach.call(document.querySelectorAll(o),function(e){a(e)})}),document.addEventListener("turbolinks:before-cache",function(){Array.prototype.forEach.call(document.querySelectorAll(o),function(e){u(e)})})}(),function(){function e(e){if(!(0!==e.button||e.ctrlKey||e.altKey||e.metaKey||e.shiftKey)){e.preventDefault();var n=document.getElementById("post_content");n.scrollIntoView(),n.value="...",t(e.target.getAttribute("data-thredded-quote-post"),function(e){if(n.ownerDocument.body.contains(n)){n.focus(),n.value=e;var t=document.createEvent("Event");t.initEvent("autosize:update",!0,!1),n.dispatchEvent(t),n.scrollIntoView()}},function(e){n.value=e})}}function t(e,t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.onload=function(){r.status>=200&&r.status<400?t(r.responseText):n("Error ("+r.status+"): "+r.statusText+" "+r.responseText)},r.onerror=function(){n("Network Error")},r.send()}window.Thredded.onPageLoad(function(){Array.prototype.forEach.call(document.querySelectorAll("[data-thredded-quote-post]"),function(t){t.addEventListener("click",e)})})}(),function(){var e="#thredded--container [data-time-ago]",t=window.Thredded;"timeago"in window?function(){var n=window.timeago;t.onPageLoad(function(){var t=document.querySelector("#thredded--container");t&&n().render(document.querySelectorAll(e),t.getAttribute("data-thredded-locale").replace("-","_"))}),document.addEventListener("turbolinks:before-cache",function(){n.cancel()})}():"jQuery"in window&&"timeago"in jQuery.fn&&function(){var n=window.jQuery;t.onPageLoad(function(){var t=n.timeago.settings.allowFuture;n.timeago.settings.allowFuture=!0,n(e).timeago(),n.timeago.settings.allowFuture=t})}()}(),function(){var e=window.Thredded,t=window.ThreddedMentionAutocompletion,n=window.ThreddedPreviewArea,r=window.autosize,o="[data-thredded-topic-form]",i='[name$="topic[title]"]',a='textarea[name$="[content]"]',u="thredded--is-compact",s="thredded--is-expanded",c=27,l=function(e){var o=e.querySelector(a);if(r(o),new n(e,o),t.init(e,o),e.classList.contains(u)){var s=e.querySelector(i);s.addEventListener("focus",function(){d(e,!0)}),[s,o].forEach(function(t){t.addEventListener("keydown",function(t){t.keyCode===c&&(t.target.blur(),d(e,!1))}),t.addEventListener("blur",function(){var t=function t(n){e.contains(n.target)||s.value||o.value||d(e,!1),document.body.removeEventListener("touchend",t),document.body.removeEventListener("mouseup",t)};document.body.addEventListener("mouseup",t),document.body.addEventListener("touchend",t)})})}},d=function(e,t){t?(e.classList.remove(u),e.classList.add(s)):(e.classList.remove(s),e.classList.add(u))},f=function(e){r.destroy(e.querySelector(a))};e.onPageLoad(function(){Array.prototype.forEach.call(document.querySelectorAll(o),function(e){l(e)})}),document.addEventListener("turbolinks:before-cache",function(){Array.prototype.forEach.call(document.querySelectorAll(o),function(e){f(e)})})}(),function(){function e(e){var t=e.match(/\/page-(\d)$/);return t?+t[1]:1}function t(e){return Math.ceil(e/u)}function n(e){do{e=e.parentNode}while(e&&"ARTICLE"!==e.tagName);return e}function r(r){r.addEventListener("click",function(r){var u=r.target;if("A"===u.tagName&&"H1"===u.parentNode.tagName){var s=n(u);e(u.href)===t(+s.querySelector(a).textContent)&&(s.classList.add(i),s.classList.remove(o))}})}var o="thredded--topic-unread",i="thredded--topic-read",a=".thredded--topics--posts-count",u=50;window.Thredded.onPageLoad(function(){Array.prototype.forEach.call(document.querySelectorAll("[data-thredded-topics]"),r)})}(),function(){var e=window.Thredded,t=window.Turbolinks;e.onPageLoad(function(){t&&t.supported&&Array.prototype.forEach.call(document.querySelectorAll("[data-thredded-turboform]"),function(e){e.addEventListener("submit",n)})});var n=function(n){n.preventDefault();var r=n.currentTarget;t.visit(r.action+(-1===r.action.indexOf("?")?"?":"&")+e.serializeForm(r)),e.hideSoftKeyboard()}}();var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();!function(){var e=window.Thredded,t="data-thredded-bound-messageboard-pref",n="data-thredded-update-checkbox-on-change",r=function(){function e(t,n,r){var o=this;_classCallCheck(this,e),this.messageboardCheckbox=t.querySelector('[type="checkbox"][name="'+r+'"]'),this.messageboardCheckbox&&(this.messageboardCheckbox.addEventListener("change",function(){o.rememberMessageboardChecked()}),this.rememberMessageboardChecked(),this.genericCheckbox=t.querySelector('[type="checkbox"][name="'+n+'"]'),this.genericCheckbox.addEventListener("change",function(){o.updateMessageboardCheckbox()}),this.updateMessageboardCheckbox())}return _createClass(e,[{key:"rememberMessageboardChecked",value:function(){this.messageboardCheckedWas=this.messageboardCheckbox.checked}},{key:"updateMessageboardCheckbox",value:function(){var e=this.genericCheckbox.checked;this.messageboardCheckbox.disabled=!e,this.messageboardCheckbox.checked=!!e&&this.messageboardCheckedWas}}]),e}(),o=function e(t,n,r){_classCallCheck(this,e);var o=t.querySelector('[type="checkbox"][name="'+r+'"]');o&&n.addEventListener("change",function(){o.checked=n.checked})},i=function e(i){_classCallCheck(this,e),Array.prototype.forEach.call(i.querySelectorAll("input["+t+"]"),function(e){new r(i,e.name,e.getAttribute(t))}),Array.prototype.forEach.call(i.querySelectorAll("input["+n+"]"),function(e){new o(i,e,e.getAttribute(n))})};e.onPageLoad(function(){Array.prototype.forEach.call(document.querySelectorAll("[data-thredded-user-preferences-form]"),function(e){new i(e)})})}(),function(){function e(e){for(var t=[],n=[],r=0,o=!1,i=!1,a=0;a<e.length;++a){var u=e.charAt(a);switch(u){case'"':o=!o;break;case" ":i&&n.push(u);break;case",":o?n.push(u):(i=!1,n.length&&(t.push({name:n.join(""),index:r}),n.length=0));break;default:i||(r=a),i=!0,n.push(u)}}return n.length&&t.push({name:n.join(""),index:r}),t}function t(e){r.destroy(e)}var n=window.Thredded,r=window.autosize,o="[data-thredded-users-select]";n.UsersSelect={DROPDOWN_MAX_COUNT:6};var i=function(t){r(t),t.addEventListener("keypress",function(e){13!==e.keyCode&&10!==e.keyCode||e.preventDefault()});var o=new Textcomplete.editors.Textarea(t),i=new Textcomplete(o,{dropdown:{className:n.UserTextcomplete.DROPDOWN_CLASS_NAME,maxCount:n.UsersSelect.DROPDOWN_MAX_COUNT}}),a=n.UserTextcomplete.searchFn({url:t.getAttribute("data-autocomplete-url"),autocompleteMinLength:parseInt(t.getAttribute("data-autocomplete-min-length"),10)});i.on("rendered",function(){i.dropdown.items.length&&i.dropdown.items[0].activate()}),i.register([{index:0,match:function(t){var n=e(t);if(n.length){var r=n[n.length-1],o=r.name,i=r.index,a=[o];return a.index=i,a}return null},search:function(n,r,o){a(n,function(n){var o=e(t.value).map(function(e){return e.name});r(n.filter(function(e){return-1===o.indexOf(e.name)}))},o)},template:n.UserTextcomplete.formatUser,replace:function(e){var t=e.name;return/,/.test(t)?'"'+t+'", ':t+", "}}])};window.Thredded.onPageLoad(function(){Array.prototype.forEach.call(document.querySelectorAll(o),function(e){i(e)})}),document.addEventListener("turbolinks:before-cache",function(){Array.prototype.forEach.call(document.querySelectorAll(o),function(e){t(e)})})}();